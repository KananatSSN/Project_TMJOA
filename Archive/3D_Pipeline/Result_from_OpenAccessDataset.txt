

Starting TMJ 3D CNN Training Pipeline with Pre-Split Data
======================================================================

1. Validating data structure and loading datasets...
Validating data structure at /content/drive/MyDrive/TMJOA_data/training_dataset_plus_openAccess...
✅ train/0: 220 valid files
✅ train/1: 241 valid files
✅ val/0: 63 valid files
✅ val/1: 61 valid files
✅ test/0: 32 valid files
✅ test/1: 39 valid files
✅ Data structure validation passed!
Loaded train split with 461 samples:
  Class 0: 220 samples
  Class 1: 241 samples
Loaded val split with 124 samples:
  Class 0: 63 samples
  Class 1: 61 samples
Loaded test split with 71 samples:
  Class 0: 32 samples
  Class 1: 39 samples
Using balanced sampling for training data

DataLoaders created:
  Train: 461 samples, 115 batches
  Val:   124 samples, 31 batches
  Test:  71 samples, 18 batches
✅ All datasets loaded successfully!

Dataset Statistics:
  Training:   461 samples
  Validation: 124 samples
  Test:       71 samples
  Total:      656 samples

2. Training Strategy Selection:
   a) Single model training (fastest, good for initial experiments)
   b) Ensemble training (best performance, multiple models)
   c) Both single and ensemble (comprehensive comparison)

3. Training Single Model...
==================================================
Training single model on pre-split data...
--------------------------------------------------

🚀 Starting Training 
📁 Logs and models will be saved to: tmj_results/checkpoints
📊 CSV log: tmj_model_training_log.csv
================================================================================


================================================================================
EPOCH   1/100 RESULTS
================================================================================
⏱️  Time: 4294.7s
📚 Learning Rate: 0.00009961

🏋️  TRAINING   → Loss: 0.047519 | Acc: 0.2000 (20.00%)
✅ VALIDATION → Loss: 0.130914 | Acc: 0.4919 (49.19%) | AUC: 0.4744
🏆 BEST VAL   → Acc: 0.4919 (49.19%)
🔧 GPU Memory: 1.63GB / 10.60GB peak
================================================================================
💾 Saved best model: tmj_results/checkpoints/tmj_model_best.pt


================================================================================
EPOCH   2/100 RESULTS
================================================================================
⏱️  Time: 4034.0s
📚 Learning Rate: 0.00009844

🏋️  TRAINING   → Loss: 0.044860 | Acc: 0.2217 (22.17%)
✅ VALIDATION → Loss: 0.042058 | Acc: 0.5806 (58.06%) | AUC: 0.6570
🏆 BEST VAL   → Acc: 0.5806 (58.06%)
🔧 GPU Memory: 2.12GB / 10.84GB peak
================================================================================
💾 Saved best model: tmj_results/checkpoints/tmj_model_best.pt


================================================================================
EPOCH   3/100 RESULTS
================================================================================
⏱️  Time: 4127.5s
📚 Learning Rate: 0.00009652

🏋️  TRAINING   → Loss: 0.044715 | Acc: 0.2391 (23.91%)
✅ VALIDATION → Loss: 0.042433 | Acc: 0.5968 (59.68%) | AUC: 0.6396
🏆 BEST VAL   → Acc: 0.5968 (59.68%)
🔧 GPU Memory: 1.63GB / 11.33GB peak
================================================================================
💾 Saved best model: tmj_results/checkpoints/tmj_model_best.pt


================================================================================
EPOCH   4/100 RESULTS
================================================================================
⏱️  Time: 4136.5s
📚 Learning Rate: 0.00009388

🏋️  TRAINING   → Loss: 0.043721 | Acc: 0.2022 (20.22%)
✅ VALIDATION → Loss: 0.044429 | Acc: 0.5242 (52.42%) | AUC: 0.6654
🏆 BEST VAL   → Acc: 0.5968 (59.68%)
🔧 GPU Memory: 1.87GB / 11.33GB peak
================================================================================


================================================================================
EPOCH   5/100 RESULTS
================================================================================
⏱️  Time: 3916.7s
📚 Learning Rate: 0.00009055

🏋️  TRAINING   → Loss: 0.043381 | Acc: 0.2609 (26.09%)
✅ VALIDATION → Loss: 0.048387 | Acc: 0.5081 (50.81%) | AUC: 0.6706
🏆 BEST VAL   → Acc: 0.5968 (59.68%)
🔧 GPU Memory: 2.36GB / 11.33GB peak
================================================================================


================================================================================
EPOCH   6/100 RESULTS
================================================================================
⏱️  Time: 3900.6s
📚 Learning Rate: 0.00008658

🏋️  TRAINING   → Loss: 0.043748 | Acc: 0.2217 (22.17%)
✅ VALIDATION → Loss: 0.046691 | Acc: 0.5081 (50.81%) | AUC: 0.6622
🏆 BEST VAL   → Acc: 0.5968 (59.68%)
🔧 GPU Memory: 2.36GB / 11.57GB peak
================================================================================


================================================================================
EPOCH   7/100 RESULTS
================================================================================
⏱️  Time: 4298.6s
📚 Learning Rate: 0.00008205

🏋️  TRAINING   → Loss: 0.043940 | Acc: 0.2109 (21.09%)
✅ VALIDATION → Loss: 0.040831 | Acc: 0.6129 (61.29%) | AUC: 0.6948
🏆 BEST VAL   → Acc: 0.6129 (61.29%)
🔧 GPU Memory: 2.36GB / 11.57GB peak
================================================================================
💾 Saved best model: tmj_results/checkpoints/tmj_model_best.pt


================================================================================
EPOCH   8/100 RESULTS
================================================================================
⏱️  Time: 4099.1s
📚 Learning Rate: 0.00007702

🏋️  TRAINING   → Loss: 0.043342 | Acc: 0.2435 (24.35%)
✅ VALIDATION → Loss: 0.043932 | Acc: 0.6129 (61.29%) | AUC: 0.6607
🏆 BEST VAL   → Acc: 0.6129 (61.29%)
🔧 GPU Memory: 2.61GB / 11.57GB peak
================================================================================


================================================================================
EPOCH   9/100 RESULTS
================================================================================
⏱️  Time: 4021.7s
📚 Learning Rate: 0.00007158

🏋️  TRAINING   → Loss: 0.043024 | Acc: 0.2522 (25.22%)
✅ VALIDATION → Loss: 0.040763 | Acc: 0.6371 (63.71%) | AUC: 0.6893
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 2.85GB / 11.82GB peak
================================================================================
💾 Saved best model: tmj_results/checkpoints/tmj_model_best.pt


================================================================================
EPOCH  10/100 RESULTS
================================================================================
⏱️  Time: 3939.5s
📚 Learning Rate: 0.00006580

🏋️  TRAINING   → Loss: 0.044507 | Acc: 0.2413 (24.13%)
✅ VALIDATION → Loss: 0.051674 | Acc: 0.4919 (49.19%) | AUC: 0.6729
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 3.10GB / 12.06GB peak
================================================================================


================================================================================
EPOCH  11/100 RESULTS
================================================================================
⏱️  Time: 4082.3s
📚 Learning Rate: 0.00005978

🏋️  TRAINING   → Loss: 0.044004 | Acc: 0.1957 (19.57%)
✅ VALIDATION → Loss: 0.040622 | Acc: 0.6210 (62.10%) | AUC: 0.6950
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 3.34GB / 12.31GB peak
================================================================================


================================================================================
EPOCH  12/100 RESULTS
================================================================================
⏱️  Time: 4062.0s
📚 Learning Rate: 0.00005361

🏋️  TRAINING   → Loss: 0.043276 | Acc: 0.2391 (23.91%)
✅ VALIDATION → Loss: 0.044470 | Acc: 0.5806 (58.06%) | AUC: 0.6789
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 3.83GB / 12.55GB peak
================================================================================


================================================================================
EPOCH  13/100 RESULTS
================================================================================
⏱️  Time: 3958.3s
📚 Learning Rate: 0.00004739

🏋️  TRAINING   → Loss: 0.042256 | Acc: 0.2174 (21.74%)
✅ VALIDATION → Loss: 0.044728 | Acc: 0.6371 (63.71%) | AUC: 0.6648
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 4.07GB / 12.80GB peak
================================================================================


================================================================================
EPOCH  14/100 RESULTS
================================================================================
⏱️  Time: 3866.5s
📚 Learning Rate: 0.00004122

🏋️  TRAINING   → Loss: 0.043759 | Acc: 0.2000 (20.00%)
✅ VALIDATION → Loss: 0.041118 | Acc: 0.6290 (62.90%) | AUC: 0.6721
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 4.32GB / 13.04GB peak
================================================================================


================================================================================
EPOCH  15/100 RESULTS
================================================================================
⏱️  Time: 4061.6s
📚 Learning Rate: 0.00003520

🏋️  TRAINING   → Loss: 0.042708 | Acc: 0.2217 (22.17%)
✅ VALIDATION → Loss: 0.040922 | Acc: 0.6371 (63.71%) | AUC: 0.6932
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 4.81GB / 13.53GB peak
================================================================================


================================================================================
EPOCH  16/100 RESULTS
================================================================================
⏱️  Time: 4160.5s
📚 Learning Rate: 0.00002942

🏋️  TRAINING   → Loss: 0.041774 | Acc: 0.2457 (24.57%)
✅ VALIDATION → Loss: 0.042595 | Acc: 0.6290 (62.90%) | AUC: 0.6953
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 5.05GB / 13.77GB peak
================================================================================


================================================================================
EPOCH  17/100 RESULTS
================================================================================
⏱️  Time: 4046.9s
📚 Learning Rate: 0.00002398

🏋️  TRAINING   → Loss: 0.042496 | Acc: 0.2652 (26.52%)
✅ VALIDATION → Loss: 0.040830 | Acc: 0.6129 (61.29%) | AUC: 0.6875
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 5.54GB / 14.26GB peak
================================================================================


================================================================================
EPOCH  18/100 RESULTS
================================================================================
⏱️  Time: 4313.9s
📚 Learning Rate: 0.00001895

🏋️  TRAINING   → Loss: 0.041802 | Acc: 0.2478 (24.78%)
✅ VALIDATION → Loss: 0.041748 | Acc: 0.6210 (62.10%) | AUC: 0.6896
🏆 BEST VAL   → Acc: 0.6371 (63.71%)
🔧 GPU Memory: 5.54GB / 14.50GB peak
================================================================================


================================================================================
EPOCH  19/100 RESULTS
================================================================================
⏱️  Time: 6123.3s
📚 Learning Rate: 0.00001442

🏋️  TRAINING   → Loss: 0.043376 | Acc: 0.2522 (25.22%)
✅ VALIDATION → Loss: 0.040617 | Acc: 0.6613 (66.13%) | AUC: 0.7002
🏆 BEST VAL   → Acc: 0.6613 (66.13%)
🔧 GPU Memory: 5.78GB / 14.75GB peak
================================================================================
💾 Saved best model: tmj_results/checkpoints/tmj_model_best.pt

Epoch  19 [Train]:  91%|###6| 105/115 [1:46:10<08:47, 52.71s/it, Loss=0.0427, Acc=0.2000, GPU=6.3GB]

